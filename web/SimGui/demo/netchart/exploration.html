<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Test</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="style.css" type="text/css" />

<!--    <script src="js/jquery.js"></script>-->
    <script src="../../lib/netchart.js"></script>
</head>
<body>
    <div id="chart" style="margin: 0 auto; clear:both;"></div>

    <div id="sidebar">
        <span id="state" class="label label-info"></span>
        <span id="infodiv" class="label label-info">bla</span>
        <table class="table">
            <tr>
                <td>Name:</td>
                <td><span id="node_name_span"></span></td>
            </tr>
            <tr>
                <td>Type:</td>
                <td><span id="node_type_span"></span></td>
            </tr>
        </table>
        <br/>
    </div>


    <script type="text/javascript">
//        parent.childGetElementById = function(id) {
//            return document.getElementById(id);
//        }
//        parent.childLoaded();

        $(document).ready(function() {
            chartOptions = {
                height: 700,
                container: $("#chart")[0],
                navigation: {
                    mode: "focusnodes",
                    initialNodes: ["3"],
                    focusNodeExpansionRadius: 1,
                    focusHistoryRelevanceCooldown: 0.4,
                    numberOfFocusNodes: 2
                },
                data: {url: "data/test.json"},
                style: {nodeRules: {
                        "radius": function(node) {
                            node.radius = Math.max(0.2, node.relevance);
                        },
                        "image": function(node) {

                            var image = null;
                            var sliceNo = 0;
                            var sliceSize = 239;

                            if (node.data.type == "pc")
                            {
                                //image = "./node-icons-pc.png";
                                image = "./PC-icon.png";
                            }
                            else if (node.data.type == "switch")
                            {
                                //image = "./node-icons-switch.png";
                                image = "./switch.png";
                            }
                            else if (node.data.type == "router")
                            {
                                //image = "./node-icons-router.png";
                                image = "./router.png";
                            }
                            else if (node.data.type == "person")
                            {
                                image = "./node-icons-male.png";
                            }
                            else
                            {
                                image = "./node-icons-case.png";
                            }

                            if (node.data.foreign) {
                                sliceNo = 1;
                            } else {
                                sliceNo = 0;
                            }

                            node.image = image;
                            node.imageSlicing = [0, sliceNo * sliceSize, sliceSize, sliceSize];
                        }
                    }},
                events: {onClick: function(event) {
                        if (event.clickNode) {
                            chart.addFocusNode(event.clickNode.id);
                            $("#state")[0].innerHTML = event.clickNode.id + " " + event.clickNode.data.type;
                            $("#node_name_span")[0].innerHTML = event.clickNode.id;
                            $("#node_type_span")[0].innerHTML = event.clickNode.data.type;
                            //alert("go");
                            //$.get('SimServlet', {request: "NewTree"}, function(responseText) {
                            //    alert("yayyyyy!");
                            //});
                            //parent.getNodeInfo(event.clickNode.id));

                            var request = new XMLHttpRequest();
                            request.open('GET', '/ServletFileUploadDownloadExample/SimServlet?request=getNodeInfo&node=2', false);  // `false` makes the request synchronous
                            request.send(null);

                            if (request.status === 200) {
                                $("#state")[0].innerHTML = request.responseText + " ?? ";
                            }

                        }
                        event.preventDefault();
                    }}
            };
            chart = new NetChart(chartOptions);
        });
    </script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
</body>
</html>
